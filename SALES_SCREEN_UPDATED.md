# ุชุญุฏูุซุงุช ุดุงุดุฉ ููุทุฉ ุงูุจูุน - Sales Screen Updates

## ๐ฏ ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ ุงูููุถุงูุฉ

### ๐ ูุธุงู ุงูุจูุน ุงูููุญุณู
- **ุฎุตู ุชููุงุฆู ูู ุงููุฎุฒูู**: ุนูุฏ ุฅุชูุงู ุงูุจูุนุ ูุชู ุฎุตู ุงููููุงุช ูู ุงููุฎุฒูู ุชููุงุฆูุงู
- **ุญูุธ ุจูุงูุงุช ุงูุนููุงุก**: ูุธุงู ุดุงูู ูุญูุธ ูุฅุฏุงุฑุฉ ุจูุงูุงุช ุงูุนููุงุก
- **ุฑุจุท ุงูููุงุชูุฑ ุจุงูุนููุงุก**: ุฑุจุท ุชููุงุฆู ููููุงุชูุฑ ูุน ุงูุนููุงุก ุงูููุณุฌููู
- **ุญูุธ ุงููุณูุฏุงุช**: ุญูุธ ุชููุงุฆู ูููุงุชูุฑุฉ ุฃุซูุงุก ุงูุนูู
- **ุชุญุฏูุซ ููุงุท ุงูุนููุงุก**: ูุธุงู ููุงุท ุชููุงุฆู ููุนููุงุก ุงูููุณุฌููู

### ๐ฅ ุฅุฏุงุฑุฉ ุงูุนููุงุก
- **ุจุญุซ ุฐูู**: ุงูุจุญุซ ูู ุงูุนููุงุก ุจุงูุงุณู ุฃู ุฑูู ุงููุงุชู
- **ุฅุถุงูุฉ ุนููุงุก ุฌุฏุฏ**: ุฅููุงููุฉ ุฅุถุงูุฉ ุนููุงุก ุฌุฏุฏ ุฃุซูุงุก ุงูุจูุน
- **ูุธุงู ุงูุนููุงุก ุงููููุฒูู**: ุชูููุฒ ุงูุนููุงุก ุงูู VIP ุจุนูุงูุฉ ูููุฒุฉ
- **ุชุชุจุน ูุดุชุฑูุงุช ุงูุนููุงุก**: ุญูุธ ุฅุฌูุงูู ูุดุชุฑูุงุช ูู ุนููู

### ๐ ุงูุฅุญุตุงุฆูุงุช ูุงูุชูุงุฑูุฑ
- **ุฅุญุตุงุฆูุงุช ุณุฑูุนุฉ**: ุนุฑุถ ุฅุญุตุงุฆูุงุช ุงููุจูุนุงุช ูู ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ
- **ููุฎุต ุงูุณูุฉ**: ุนุฑุถ ุชูุตููู ููุญุชููุงุช ุงูุณูุฉ
- **ุชูุงุฑูุฑ ุงููุจูุนุงุช**: ุฅุญุตุงุฆูุงุช ุดุงููุฉ ูููุจูุนุงุช

### ๐จ ุชุญุณููุงุช ูุงุฌูุฉ ุงููุณุชุฎุฏู
- **ุดุฑูุท ุจุญุซ ูุญุณู**: ุจุญุซ ูู ุงูููุชุฌุงุช ูุงูุนููุงุก
- **ุนุฑุถ ุจูุงูุงุช ุงูุนููู**: ุฅุธูุงุฑ ุจูุงูุงุช ุงูุนููู ุงููุฎุชุงุฑ ูู ุงููุงุชูุฑุฉ
- **ุฑุณุงุฆู ุชุฃููุฏ**: ุฑุณุงุฆู ูุงุถุญุฉ ูุญุงูุงุช ุงููุฌุงุญ ูุงูุฎุทุฃ
- **ูุงูุฐุฉ ุฅูุตุงู**: ุนุฑุถ ุชูุงุตูู ุงูุจูุน ุจุนุฏ ุงูุฅุชูุงู

## ๐ง ุงููุธุงุฆู ุงูููุญุฏุซุฉ

### ูู `SaleProvider`:
```dart
// ุฅุชูุงู ุงูุจูุน ูุน ุงูุชุญุฏูุซุงุช ุงูุชููุงุฆูุฉ
Future<bool> completeSale()

// ุฅุฏุงุฑุฉ ุงูุนููุงุก
Future<void> loadCustomers()
void searchCustomers(String query)
void selectCustomer(CustomerModel customer)

// ุญูุธ ุงููุณูุฏุงุช
void _saveDraft()
String getSalesSummary()
```

### ูู `SalesScreen`:
```dart
// ููุงูุฐ ุงูุนููุงุก
void _showCustomerSelectionDialog(SaleProvider provider)
void _showCustomerDialog(SaleProvider provider)

// ุงูุฅุญุตุงุฆูุงุช
void _showQuickStats(SaleProvider provider)
void _showCartSummary(SaleProvider provider)

// ุชุญุณููุงุช ุงููุงุฌูุฉ
void _showReceiptDialog(SaleProvider provider)
Widget _buildStatRow(String label, String value)
```

## ๐ ุนูููุงุช ุงููุธุงู

### 1. ุฅุถุงูุฉ ููุชุฌ ูููุงุชูุฑุฉ:
```dart
// ุงูุชุญูู ูู ุชููุฑ ุงููููุฉ
if (product.quantity < quantity) {
  _setError('ุงููููุฉ ุงููุทููุจุฉ ุบูุฑ ูุชููุฑุฉ. ุงููุชุงุญ: ${product.quantity}');
  return false;
}

// ุฅุถุงูุฉ ุฃู ุชุญุฏูุซ ุงูููุชุฌ
final saleItem = SaleItem(
  productId: product.id!,
  productCode: product.code,
  productName: product.name,
  unitPrice: product.salePrice,
  quantity: quantity,
  total: product.salePrice * quantity,
);

_currentSaleItems.add(saleItem);
_saveDraft(); // ุญูุธ ุชููุงุฆู
```

### 2. ุฅุชูุงู ุงูุจูุน:
```dart
// ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช
for (final item in _currentSaleItems) {
  final productResult = await _productRepository.getProductByCode(item.productCode);
  // ุงูุชุญูู ูู ุชููุฑ ุงููููุฉ
}

// ุฅูุดุงุก ูุญูุธ ุงููุงุชูุฑุฉ
final saleModel = SaleModel(/*...*/);
final saveResult = await _saleRepository.saveSale(saleModel);

// ุญูุธ ุจูุงูุงุช ุงูุนููู ูุฑุจุทูุง ุจุงููุงุชูุฑุฉ
if (_customerName != null && _customerName!.isNotEmpty) {
  await _saveCustomerData(saveResult.data!);
}
```

### 3. ุชุญุฏูุซ ุงููุฎุฒูู:
```sql
-- ูู SaleRepository.saveSale()
UPDATE Items 
SET quantity = quantity - ? 
WHERE id = ?
```

### 4. ุญูุธ ุจูุงูุงุช ุงูุนููู:
```dart
// ุงูุจุญุซ ุนู ุงูุนููู ุงูููุฌูุฏ
final result = await _customerRepository.getCustomerByPhone(_customerPhone!);

if (existingCustomer != null) {
  // ุชุญุฏูุซ ุจูุงูุงุช ุงูุนููู
  final updatedCustomer = existingCustomer.copyWith(
    totalPurchases: existingCustomer.totalPurchases + total,
    points: existingCustomer.points + (total / 10).floor(),
  );
  await _customerRepository.updateCustomer(updatedCustomer);
} else {
  // ุฅุถุงูุฉ ุนููู ุฌุฏูุฏ
  final newCustomer = CustomerModel(/*...*/);
  await _customerRepository.addCustomer(newCustomer);
}
```

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. ุจุฏุก ุงูุจูุน:
- ุงูุชุญ ุดุงุดุฉ ููุทุฉ ุงูุจูุน
- ุงุจุญุซ ุนู ุงูููุชุฌุงุช ุจุงุณุชุฎุฏุงู ุงูุจุงุฑููุฏ ุฃู ุงุณู ุงูููุชุฌ
- ุฃุถู ุงูููุชุฌุงุช ููุณูุฉ

### 2. ุฅุถุงูุฉ ุนููู:
- ุงุถุบุท ุนูู ุฃููููุฉ ุงูุจุญุซ ุนู ุงูุนููุงุก
- ุงุจุญุซ ุนู ุนููู ููุฌูุฏ ุฃู ุฃุถู ุนูููุงู ุฌุฏูุฏุงู
- ุณูุชู ุฑุจุท ุงููุงุชูุฑุฉ ุจุงูุนููู ุชููุงุฆูุงู

### 3. ุชุทุจูู ุฎุตููุงุช:
- ุงุถุบุท ุนูู ุฒุฑ "ุฎุตู" ูุชุทุจูู ุฎุตู ุนุงู
- ุฃู ุงุถุบุท ุนูู ููุชุฌ ูุนูู ูุชุทุจูู ุฎุตู ุนูู ุงูููุชุฌ

### 4. ุฅุชูุงู ุงูุจูุน:
- ุงุถุบุท ุนูู ุฒุฑ "ุฏูุน"
- ุงุฎุชุฑ ุทุฑููุฉ ุงูุฏูุน ูุฃุฏุฎู ุงููุจูุบ
- ุณูุชู ุฎุตู ุงููููุงุช ูู ุงููุฎุฒูู ุชููุงุฆูุงู
- ุณูุชู ุญูุธ ุจูุงูุงุช ุงูุนููู ูุชุญุฏูุซ ููุงุทู

### 5. ุทุจุงุนุฉ ุงููุงุชูุฑุฉ:
- ุจุนุฏ ุฅุชูุงู ุงูุจูุนุ ุงุฎุชุฑ "ุทุจุงุนุฉ" ูู ูุงูุฐุฉ ุงูุชุฃููุฏ
- ุฃู ุงุณุชุฎุฏู ุฎูุงุฑุงุช ุงูุทุจุงุนุฉ ูู ุงูุดุฑูุท ุงูุนููู

## ๐ ุงูุญูุงูุฉ ูุงูุชุญูู

### ุงูุชุญูู ูู ุงููุฎุฒูู:
- ูุญุต ุชููุฑ ุงููููุฉ ูุจู ุงูุฅุถุงูุฉ
- ููุน ุงูุจูุน ุนูุฏ ุนุฏู ุชููุฑ ูููุฉ ูุงููุฉ
- ุชุญุฏูุซ ุงููุฎุฒูู ููุฑู ุจุนุฏ ุงูุจูุน

### ุงูุชุญูู ูู ุงูุจูุงูุงุช:
- ุงูุชุญูู ูู ุตุญุฉ ุจูุงูุงุช ุงูุนููู
- ุงูุชุญูู ูู ุตุญุฉ ูุจูุบ ุงูุฏูุน
- ููุน ุฅุชูุงู ุงูุจูุน ุจุฏูู ุนูุงุตุฑ

### ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก:
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ูููุณุชุฎุฏู
- ุชุฑุงุฌุน ุชููุงุฆู ูู ุญุงูุฉ ูุดู ุงูุนูููุฉ
- ุญูุธ ุงููุณูุฏุงุช ูููุน ููุฏุงู ุงูุจูุงูุงุช

## ๐ ุงูุฅุญุตุงุฆูุงุช ุงููุชุงุญุฉ

### ุฅุญุตุงุฆูุงุช ุณุฑูุนุฉ:
- ุนุฏุฏ ุงููุจูุนุงุช ุงูููููุฉ
- ุฅุฌูุงูู ุงูุฅูุฑุงุฏุงุช
- ูุชูุณุท ูููุฉ ุงูุจูุน
- ุนุฏุฏ ุงูููุชุฌุงุช ุงููุจุงุนุฉ

### ุชูุงุฑูุฑ ุงูุนููุงุก:
- ุฅุฌูุงูู ูุดุชุฑูุงุช ูู ุนููู
- ููุงุท ุงูุนููุงุก
- ุงูุนููุงุก ุงููููุฒูู

## ๐จ ุชุฎุตูุต ุงููุงุฌูุฉ

### ุงูุฃููุงู ูุงูุซููุงุช:
- ุฃููุงู ูุชูุงุณูุฉ ููุนูุงุตุฑ ุงููุฎุชููุฉ
- ุชูููุฒ ุงูุนููุงุก ุงููููุฒูู
- ุฑููุฒ ูุงุถุญุฉ ูููุธุงุฆู

### ุงูุงุณุชุฌุงุจุฉ:
- ุชุตููู ูุชุฌุงูุจ ููุดุงุดุงุช ุงููุฎุชููุฉ
- ุชุฎุทูุท ูุฎุชูู ููุดุงุดุงุช ุงููุจูุฑุฉ ูุงูุตุบูุฑุฉ
- ุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู ุนูู ุงูุฃุฌูุฒุฉ ุงููุฎุชููุฉ

## ๐ง ุงูุชุญุณููุงุช ุงููุณุชูุจููุฉ

### ููุฒุงุช ูุงุฏูุฉ:
- ูุธุงู ุงูููุงุก ูุงูููุงูุขุช
- ุชูุงุฑูุฑ ููุตูุฉ ุจุงูุฑุณูู ุงูุจูุงููุฉ
- ุฏุนู ุฃููุงุฏ ุงูุฎุตู
- ูุธุงู ุงูุฅุฑุฌุงุน ูุงูุงุณุชุจุฏุงู
- ุชูุงูู ูุน ุฃูุธูุฉ ุงูุฏูุน ุงูุฅููุชุฑููู

### ุชุญุณููุงุช ุงูุฃุฏุงุก:
- ุชุญุณูู ุณุฑุนุฉ ุงูุจุญุซ
- ุชุญุณูู ุงุณุชููุงู ุงูุฐุงูุฑุฉ
- ุฏุนู ููุงุนุฏ ุจูุงูุงุช ุฃูุจุฑ
- ุชุญุณูู ูุงุฌูุฉ ุงููุณุชุฎุฏู

---

## ๐ ุงูุฏุนู ูุงููุณุงุนุฏุฉ

ูุฃู ุงุณุชูุณุงุฑุงุช ุฃู ูุดุงููุ ูุฑุฌู ุงูุฑุฌูุน ุฅูู:
- ูููุงุช ุงูุชูุซูู ุงูุฅุถุงููุฉ
- ุดุงุดุฉ ุงูุฅุนุฏุงุฏุงุช ูุชุฎุตูุต ุงููุธุงู
- ุณุฌู ุงูุฃุฎุทุงุก ูุชุชุจุน ุงููุดุงูู

ุงููุธุงู ุงูุขู ุฌุงูุฒ ููุงุณุชุฎุฏุงู ุจุฌููุน ุงููุธุงุฆู ุงููุทููุจุฉ! ๐
